<img src="../../../assets/images/mlops-crash-course/tong-quan-he-thong/phan-tich-van-de/planning.jpg" loading="lazy"/>

Một hệ thống ML cũng chính là một hệ thống phần mềm. Khi đi xây dựng một hệ thống phần mềm, việc đầu tiên cần làm chính là định nghĩa vấn đề, định lượng hoá định nghĩa đó thành các yêu cầu có thể đánh giá được, và đề xuất các giải pháp khả thi để giải quyết các yêu cầu đó. Vấn đề cốt lõi khi đi xây dựng một hệ thống ML vẫn là vấn đề kinh doanh của một tổ chức.

Trong khoá học này, chúng ta giả sử rằng tổ chức của bạn hiểu về ML, và quyết định chọn giải pháp sử dụng ML để giải quyết một vấn đề kinh doanh, đó là: *Dự đoán xem tài xế có hoàn thành một cuốc xe hay không?*. Quá trình định nghĩa vấn đề kinh doanh này bao gồm quá trình trả lời cho nhiều câu hỏi. Bảng dưới đây liệt kê các câu hỏi tiêu biểu và các câu trả lời cho vấn đề của chúng ta trong khoá học này.

| **Chủ đề**             | **Câu hỏi**                                                                              | **Trả lời**                                                                                                                                                                        |
|------------------------|------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Mục tiêu**           | Các mục tiêu kinh doanh?                                                                 | Tăng số lượng các cuốc xe được hoàn thành trong 1 tháng lên 10%                                                                                                                    |
|                        | Các chức năng chính của hệ thống?                                                        | Rank xác suất hoàn thành cuốc xe của driver được chọn                                                                                                                              |
| **Các bên liên quan**  | Ai là người tham gia? Vai trò và trách nhiệm?                                            | Product owner, Product manager, Solution Architect, Data Scientist, Data engineer, ML engineer                                                                                     |
|                        | Ai cần được thông báo về dự án?                                                          | Head of Engineering, CTO, CEO                                                                                                                                                      |
|                        | Ai là người dùng cuối?                                                                   | Khách hàng                                                                                                                                                                         |
| **Data**               | Có thể lấy ở các nguồn nào?                                                              | Static data và streaming data từ app của công ty                                                                                                                                   |
|                        | Định nghĩa quy trình để transform data sang format có thể dùng được?                     | Giả sử quy trình để transform và clean data, feature engineering đã được định nghĩa                                                                                                |
| **Phát triển models**  | Có những giải pháp nào đã được thực hiện để so sánh và đối chiếu?                        | Giả sử đã tìm hiểu các giải pháp trên internet và của các đối thủ cạnh tranh                                                                                                       |
|                        | Có những thresholds nào được sử dụng để khiến giải pháp trở nên hữu ích?                 | Quá trình inference không được chạy quá 500ms                                                                                                                                      |
|                        | Cân nhắc các tradeoffs                                                                   | False positives (false alarm) có ảnh hưởng nghiêm trọng hơn                                                                                                                        |
|                        | Giải pháp ML của chúng ta có cần được interpretable không? Nếu có thì giải thích cho ai? | Giải pháp này có yêu cầu interpretable, để có thể giúp các bộ phận khác của công ty đưa ra giải pháp để tối ưu các features                                                        |
|                        | Giải pháp ML này có cần confidence score không? Nếu có thì dùng threshold nào?           | Sử dụng threshold 0.5. Thông qua các POC sau đó mà chúng ta sẽ tối ưu threshold này sau                                                                                            |
|                        | Làm gì với các predictions thoả mãn và không thoả mãn threshold?                         | Các predictions dù thoả mãn threshold hay không thì đều được log lại và gán label sau                                                                                              |
| **Đánh giá models**    | Dùng metrics nào để đánh giá trong giai đoạn development và production?                  | Dùng metrics Accuracy                                                                                                                                                              |
|                        | Làm sao để liên kết model performance với mục tiêu kinh doanh?                           | Ở production, ngoài Accurcacy để đánh giá model performance, chúng ta cần tính cả tỉ lệ hoàn thành các cuốc xe trong 1 tháng gần nhất, để đánh giá mục tiêu kinh doanh             |
| **Triển khai models**  | Data của quá trình inference sẽ được lấy từ đâu? Được format và lưu trữ thế nào?         | Data đầu vào của quá trình inference sẽ được lấy từ static DB và streaming DB                                                                                                      |
|                        | Model được deploy lên đâu?                                                               | Model được deploy lên hệ thống on-premise của công ty                                                                                                                              |
|                        | Khi nào chạy batch prediction? Khi nào chạy online prediction?                           | Model sẽ được đóng gói để có thể serve được cả batch và online                                                                                                                                                                               |
|                        | Tốc độ thay đổi của data thế nào?                                                        | Vài features sẽ thay đổi không thường xuyên, có thể schedule để chạy và update hàng ngày. Vài features cần lấy từ streaming data, cần data pipeline riêng để preprocess và lưu trữ |
|                        | Bao lâu thì cần train lại model?                                                         | Dựa vào tốc độ thay đổi của data hoặc feature drift                                                                                                                                |
|                        | Labels ở production được thu thập như thế nào?                                           | Sau khi tài xế được chọn, trải qua một vài quy trình khác, chúng ta thu thập được kết quả xem cuốc xe có hoàn thành không                                                          |
| **Quyền riêng tư**     | Có những yêu cầu nào về quyền riêng tư của data, labels, v.v                             | Data và labels chỉ được dùng trong nội bộ công ty                                                                                                                                  |
|                        | Hệ thống có thể được kết nối với internet không?                                         | Có                                                                                                                                                                                 |
|                        | Chúng ta có thể giữ data của users trong bao lâu?                                        | Không giới hạn                                                                                                                                                                     |
| **Chi phí và lợi ích** | Ngân sách ban đầu                                                                        | 500k$                                                                                                                                                                              |
|                        | So sánh chi phí và lợi ích                                                               | Lợi ích lớn hơn chi phí nhiều, vì hệ thống có thể tái sử dụng, chi phí để optimize không lớn                                                                                       |
|                        | Cần đạt được các yêu cầu nào để tăng budget?                                             | Hoàn thành các mốc thời gian tiếp theo, triển khai model ra production và chứng minh lợi ích lớn hơn chi phí                                                                       |
| **Rủi ro**             | Phân tích các rủi ro đi kèm khi thực hiện mỗi chức năng                                  | Có thể model được đánh giá offline là tốt, nhưng khi ra production, lại không thể chứng minh là mang lại hiệu quả                                                                  |
|                        | Phân tích các rủi ro kinh doanh khác                                                     | Hết tiền trước khi hoàn thiện POC                                                                                                                                                  |
| **Ràng buộc kĩ thuật** | Có hệ thống nào trong công ty chúng ta cần tích hợp với không?                           | Không                                                                                                                                                                              |
|                        | Architecture và tools sẽ dùng?                                                           | Phải tối ưu chi phí, chỉ được dùng open-source tools                                                                                                                               |
| **Các mốc thời gian**  | Thời gian được phân bổ như thế nào cho từng chức năng?                                   | Timeline ở hình dưới                                                                                                                                                               |                                                                                                                               |

Về các mốc thời gian của dự án, hình dưới đây là một ví dụ của một dự án trong thực thế:

<img src="../../../assets/images/mlops-crash-course/tong-quan-he-thong/phan-tich-van-de/timeline.png" loading="lazy"/>

Ngoài các câu hỏi cơ bản ở trên, tuỳ thuộc vào vấn đề kinh doanh mà sẽ có các vấn đề và các câu hỏi đi kèm khác. Trong bảng trên, nhiều câu trả lời liên quan tới phía kinh doanh của công ty, hơn là liên quan tới MLOps, đã được trả lời ngắn gọn. Những câu trả lời này thông thường cần được một nhóm các Data Analyst và Business Strategist dành thời gian thảo luận, phân tích và trả lời. Lưu ý rằng câu trả lời cho các câu hỏi trên sẽ được cập nhật liên tục trong quá trình thực hiện dự án, bằng nhiều vòng lặp. Chúng ta không thể mong đợi rằng mọi thứ sẽ được trả lời đúng ngay từ khi còn chưa bắt đầu thực hiện nó. Các bạn có thể tham khảo thêm [ở đây](https://ml-ops.org/content/phase-zero) về các câu hỏi khác khi định nghĩa vấn đề kinh doanh.

Ngoài ra, trong quá trình phát triển hệ thống, mọi thành viên trong dự án đều cần chú ý tới bốn tính chất cơ bản của một hệ thống ML, bao gồm Reliability, Scalability, Maintainability, và Adaptability. Các bạn có thể đọc thêm ở khoá học [CS 329S: Machine Learning Systems Design](https://docs.google.com/document/d/1C3dlLmFdYHJmACVkz99lSTUPF4XQbWb_Ah7mPE12Igo/edit#heading=h.f2r0clc6xjgx) để hiểu rõ hơn về bốn tính chất này.

Sau khi đã trả lời một loạt các câu hỏi trên, chúng ta đã có một cái nhìn kĩ lưỡng hơn về problem mà chúng ta đang giải quyết. Dựa vào Timeline đã được định nghĩa ở trên, tiếp theo chúng ta sẽ thực hiện POC. Ở bước kế tiếp này, chúng ta cũng sẽ bắt đầu làm quen với các tool giúp đẩy nhanh quá trình làm việc, các tool này cùng nhau làm nên một thứ gọi là MLOps platform.
